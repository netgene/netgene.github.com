---
layout: post
title: 进程、线程、协程
date: 2013-02-11 18:28:58
categories:
- 语言与设计
tags:
---

### 进程

### 线程 多线程

同一进程间的线程究竟共享哪些资源呢，而又各自独享哪些资源呢？

共享的资源有：  
- 堆  由于堆是在进程空间中开辟出来的，所以它是理所当然地被共享的；因此new出来的都是共享的（16位平台上分全局堆和局部堆，局部堆是独享的）
- 全局变量 它是与具体某一函数无关的，所以也与特定线程无关；因此也是共享的
- 静态变量 虽然对于局部变量来说，它在代码中是“放”在某一函数中的，但是其存放位置和全局变量一样，存于堆中开辟的.bss和.data段，是共享的
- 文件等公用资源  这个是共享的，使用这些公共资源的线程必须同步。Win32 提供了几种同步资源的方式，包括信号、临界区、事件和互斥体。

独享的资源有  
- 栈 栈是独享的 线程函数可以调用函数，而被调用函数中又是可以层层嵌套的，所以线程
   必须拥有自己的函数堆栈， 使得函数调用可以正常执行，不受其他线程的影响。
- 寄存器  这个可能会误解，因为电脑的寄存器是物理的，每个线程去取值难道不一样吗？其实线程里存放的是副本，包括程序计数器PC

### 协程

### 进程、线程、协程

- 进程拥有自己独立的堆和栈，既不共享堆，亦不共享栈，进程由操作系统调度。
- 线程拥有自己独立的栈和共享的堆，共享堆，不共享栈，线程亦由操作系统调度(标准线程是的)。
- 协程和线程一样共享堆，不共享栈，协程由程序员在协程的代码里显示调度。


一个由c/C++编译的程序占用的内存分为以下几个部分：
- 栈区（stack）— 由编译器自动分配释放，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈。
- 堆区（heap） — 一般由程序员分配释放，若程序员不释放，程序结束时可能由OS回收。注意它与数据结构中的堆是两回事，分配方式倒是类似于链表。
- 全局区（静态区）（static）—，全局变量和静态变量的存储是放在一块的，初始化的全局变量和静态变量在一块区域，未初始化的全局变量和未初始化的静态变量在相邻的另一块区域。 - 程序结束后由系统释放。
- 文字常量区   —常量字符串就是放在这里的。程序结束后由系统释放。
- 程序代码区—存放函数体的二进制代码。


栈空间大小限制：通过命令 ulimit -s 查看linux的默认栈空间大小，默认情况下 为10240 即10M