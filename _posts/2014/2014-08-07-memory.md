---
layout: post
title: 内存管理
date: 2014-08-07 20:20:20
categories:
- 语言与设计
tags:
- memory
---

#### C语言跟内存分配方式
- 从静态存储区域分配.
       内存在程序编译的时候就已经分配好，这块内存在程序的整个运行期间都存在.例如全局变量、static变量.
- 在栈上创建
       在执行函数时，函数内局部变量的存储单元都可以在栈上创建，函数执行结束时这些存储单元自动被释放.栈内存分配运算内置于处理器的指令集中，效率很高，但是分配的内存容量有限.
- 从堆上分配，亦称动态内存分配.
       程序在运行的时候用malloc或new申请任意多少的内存，程序员自己负责在何时用free或delete释放内存.动态内存的生存期由用户决定，使用非常灵活，但问题也最多.


C语言跟内存申请相关的函数主要有 alloca、calloc、malloc、free、realloc等.

    <1>alloca是向栈申请内存,因此无需释放.
    <2>malloc分配的内存是位于堆中的,并且没有初始化内存的内容,因此基本上malloc之后,调用函数memset来初始化这部分的内存空间.
    <3>calloc则将初始化这部分的内存,设置为0.
    <4>realloc则对malloc申请的内存进行大小的调整.
    <5>申请的内存最终需要通过函数free来释放.
    当程序运行过程中malloc了,但是没有free的话,会造成内存泄漏.一部分的内存没有被使用,但是由于没有free,因此系统认为这部分内存还在使用,造成不断的向系统申请内存,使得系统可用内存不断减少.但是内存泄漏仅仅指程序在运行时,程序退出时,OS将回收所有的资源.因此,适当的重起一下程序,有时候还是有点作用.


[动态数组的 C 实现 https://blog.codingnow.com/2009/11/array_c.html](https://blog.codingnow.com/2009/11/array_c.html)